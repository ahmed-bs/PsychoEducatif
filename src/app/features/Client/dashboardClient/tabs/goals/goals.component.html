<!-- Calendar Sidebar Toggle Button -->
<button (click)="toggleSidebar()" class="calendar-toggle-btn" [class.active]="sidebarOpen" [title]="'dashboard_tabs.goals.toggle_calendar' | translate">
  <i class="fas" [ngClass]="sidebarOpen ? 'fa-times' : 'fa-calendar-alt'"></i>
</button>

<!-- Main Content Wrapper -->
<div class="goals-main-wrapper" [class.sidebar-open]="sidebarOpen">
<!-- Empty State: No Goals - Show bubble outside card -->
<div *ngIf="goals.length === 0" class="empty-competencies-state">
  <div class="empty-state-content">
    <div class="message-cloud">
      <div class="cloud-content">
        <div class="cloud-bear-icon">
          <img src="assets/img/bear.png" alt="Bear" class="bear-icon-image">
        </div>
        <h3 class="cloud-title">{{ 'dashboard_tabs.goals.no_goals.title' | translate }}</h3>
        <p class="cloud-text">{{ 'dashboard_tabs.goals.no_goals.message' | translate }}</p>
      </div>
    </div>
  </div>
</div>

<!-- Goals List - Modern Card Design -->
<div *ngIf="goals.length > 0" class="goals-container">
  <div class="goals-grid">
    <div *ngFor="let goal of goals" class="goal-card">
      <!-- Card Header -->
      <div class="goal-card-header">
        <div class="goal-icon">
          <i class="fas fa-bullseye"></i>
        </div>
        <div class="goal-header-content">
          <h3 class="goal-title">{{ goal.title }}</h3>
          <span class="goal-priority-badge" [ngClass]="{
            'priority-high': goal.priority === 'high',
            'priority-medium': goal.priority === 'medium',
            'priority-low': goal.priority === 'low'
          }">
            {{ getPriorityTranslation(goal.priority) }}
          </span>
        </div>
      </div>

      <!-- Card Body -->
      <div class="goal-card-body">
        <p class="goal-description">{{ goal.description }}</p>
        
        <div class="goal-meta">
          <div class="goal-meta-item">
            <i class="fas fa-calendar-alt"></i>
            <span>{{ formatDate(goal.target_date) }}</span>
          </div>
          <div *ngIf="hasRepetition(goal)" class="goal-meta-item">
            <i class="fas fa-repeat"></i>
            <span class="repetition-badge">{{ getRepetitionTypeTranslation(goal.repetition_type) }}</span>
          </div>
        </div>
      </div>

      <!-- Card Footer -->
      <div class="goal-card-footer">
        <button (click)="onGoalClick(goal)"
                [ngClass]="{
                  'quiz-btn-active': isQuizAvailable(goal),
                  'quiz-btn-disabled': !isQuizAvailable(goal)
                }"
                [disabled]="!isQuizAvailable(goal)"
                [title]="getQuizAvailabilityMessage(goal)"
                class="quiz-btn">
          <i class="fas fa-question-circle"></i>
          <span>{{ 'dashboard_tabs.goals.take_quiz' | translate }}</span>
        </button>
        
        <div class="goal-actions">
          <button (click)="onEditGoalClick(goal)" class="action-btn edit-btn" title="{{ 'dashboard_tabs.goals.edit' | translate }}">
            <i class="fas fa-edit"></i>
          </button>
          <button (click)="onDeleteGoalClick(goal.id)" class="action-btn delete-btn" title="{{ 'dashboard_tabs.goals.delete' | translate }}">
            <i class="fas fa-trash-alt"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Floating Action Button for Adding Goals -->
<div class="floating-button-wrapper">
    <span class="floating-button-label">{{ 'dashboard_tabs.goals.add_new_goal' | translate }}</span>
  <button (click)="onAddGoalClick()"
    class="floating-add-button"
    [title]="'dashboard_tabs.goals.add_new_goal' | translate">
    <i class="fas fa-plus"></i>
  </button>

</div>

<!-- Calendar Sidebar -->
<div class="calendar-sidebar" [class.open]="sidebarOpen">
  <div class="calendar-sidebar-header">
    <h3 class="calendar-sidebar-title">
      <i class="fas fa-calendar-alt"></i>
      {{ 'dashboard_tabs.goals.calendar_title' | translate }}
    </h3>
    <button (click)="toggleSidebar()" class="calendar-sidebar-close" [title]="'dashboard_tabs.goals.close_calendar' | translate">
      <i class="fas fa-times"></i>
    </button>
  </div>
  <div class="calendar-sidebar-content">
    <app-calendar 
      [goals]="goals" 
      [inProgressDomains]="[]"
      (goalSaved)="onGoalSaved()">
    </app-calendar>
  </div>
</div>

<!-- Sidebar Overlay -->
<div class="sidebar-overlay" [class.active]="sidebarOpen" (click)="toggleSidebar()"></div>
</div>