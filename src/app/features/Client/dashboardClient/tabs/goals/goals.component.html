
<!-- Main Content Wrapper -->
<div class="goals-main-wrapper" [class.sidebar-open]="sidebarOpen">
<!-- Empty State: No Goals - Show bubble outside card -->
<div *ngIf="goals.length === 0" class="empty-competencies-state">
  <div class="empty-state-content">
    <div class="message-cloud">
      <div class="cloud-content">
        <div class="cloud-bear-icon">
          <img src="assets/img/bear.png" alt="Bear" class="bear-icon-image">
        </div>
        <h3 class="cloud-title">{{ 'dashboard_tabs.goals.no_goals.title' | translate }}</h3>
        <p class="cloud-text">{{ 'dashboard_tabs.goals.no_goals.message' | translate }}</p>
      </div>
    </div>
  </div>
</div>

<!-- Goals List - Modern Card Design -->
<div *ngIf="goals.length > 0" class="goals-container">
  <div class="goals-grid">
    <div *ngFor="let goal of goals" class="goal-card">
      <!-- Card Header -->
      <div class="goal-card-header">
        <div class="goal-icon">
          <i class="fas fa-bullseye"></i>
        </div>
        <div class="goal-header-content">
          <h3 class="goal-title">{{ goal.title }}</h3>
          <span class="goal-priority-badge" [ngClass]="{
            'priority-high': goal.priority === 'high',
            'priority-medium': goal.priority === 'medium',
            'priority-low': goal.priority === 'low'
          }">
            {{ getPriorityTranslation(goal.priority) }}
          </span>
        </div>
      </div>

      <!-- Card Body -->
      <div class="goal-card-body">
        <p class="goal-description">{{ goal.description }}</p>
        
        <div class="goal-meta">
          <div class="goal-meta-item">
            <i class="fas fa-calendar-alt"></i>
            <span>{{ formatDate(goal.target_date) }}</span>
          </div>
          <div *ngIf="hasRepetition(goal)" class="goal-meta-item">
            <i class="fas fa-repeat"></i>
            <span class="repetition-badge">{{ getRepetitionTypeTranslation(goal.repetition_type) }}</span>
          </div>
        </div>
      </div>

      <!-- Card Footer -->
      <div class="goal-card-footer">
        <button (click)="onGoalClick(goal)"
                [ngClass]="{
                  'quiz-btn-active': isQuizAvailable(goal),
                  'quiz-btn-disabled': !isQuizAvailable(goal)
                }"
                [disabled]="!isQuizAvailable(goal)"
                [title]="getQuizAvailabilityMessage(goal)"
                class="quiz-btn">
          <i class="fas fa-question-circle"></i>
          <span>{{ 'dashboard_tabs.goals.take_quiz' | translate }}</span>
        </button>
        
        <div class="goal-actions">
          <button (click)="onEditGoalClick(goal)" class="action-btn edit-btn" title="{{ 'dashboard_tabs.goals.edit' | translate }}">
            <i class="fas fa-edit"></i>
          </button>
          <button (click)="onDeleteGoalClick(goal)" class="action-btn delete-btn" title="{{ 'dashboard_tabs.goals.delete' | translate }}">
            <i class="fas fa-trash-alt"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Floating Action Button for Adding Goals -->
<div class="floating-button-wrapper">
    <span class="floating-button-label">{{ 'dashboard_tabs.goals.add_new_goal' | translate }}</span>
  <button (click)="onAddGoalClick()"
    class="floating-add-button"
    [title]="'dashboard_tabs.goals.add_new_goal' | translate">
    <i class="fas fa-plus"></i>
  </button>

</div>

<!-- Update Target Date Confirmation Modal -->
<div *ngIf="showUpdateDateModal" class="modal-overlay" (click)="closeUpdateDateModal()">
  <div class="update-date-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <div class="modal-header-content">
        <div class="modal-icon-wrapper">
          <i class="fas fa-calendar-alt"></i>
        </div>
        <div class="modal-title-wrapper">
          <h3 class="modal-title">
            {{ 'dashboard_tabs.goals.update_date_title' | translate }}
          </h3>
          <p class="modal-subtitle">{{ 'dashboard_tabs.goals.update_date_message' | translate }}</p>
        </div>
      </div>
      <button 
        type="button"
        class="modal-close-btn"
        (click)="closeUpdateDateModal()"
        [attr.aria-label]="'dashboard_tabs.goals.cancel' | translate">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="modal-body">
      <div class="update-date-info" *ngIf="goalToUpdate">
        <div class="info-item-compact">
          <i class="fas fa-calendar-plus"></i>
          <span class="info-text">{{ 'dashboard_tabs.goals.new_target_date' | translate }}: <strong>{{ 'dashboard_tabs.goals.tomorrow' | translate }}</strong></span>
        </div>
      </div>
    </div>

    <div class="modal-footer">
      <button 
        type="button"
        class="modal-btn-secondary"
        (click)="cancelUpdateTargetDate()"
        [disabled]="updatingDate">
        <i class="fas fa-times"></i>
        {{ 'dashboard_tabs.goals.no_update' | translate }}
      </button>
      <button 
        type="button"
        class="modal-btn-primary"
        (click)="confirmUpdateTargetDate()"
        [disabled]="updatingDate">
        <i class="fas fa-check"></i>
        {{ updatingDate ? ('dashboard_tabs.goals.updating' | translate) : ('dashboard_tabs.goals.yes_update' | translate) }}
      </button>
    </div>
  </div>
</div>

<!-- Delete Goal Confirmation Modal -->
<div *ngIf="showDeleteGoalModal" class="modal-overlay" (click)="closeDeleteGoalModal()">
  <div class="update-date-modal delete-goal-modal" (click)="$event.stopPropagation()">
    <div class="modal-header delete-modal-header">
      <div class="modal-header-content">
        <div class="modal-icon-wrapper delete-icon-wrapper">
          <i class="fas fa-exclamation-triangle"></i>
        </div>
        <div class="modal-title-wrapper">
          <h3 class="modal-title">
            {{ 'dashboard_tabs.goals.delete_confirmation_title' | translate }}
          </h3>
          <p class="modal-subtitle">{{ 'dashboard_tabs.goals.delete_confirmation_message' | translate }}</p>
        </div>
      </div>
      <button 
        type="button"
        class="modal-close-btn"
        (click)="closeDeleteGoalModal()"
        [attr.aria-label]="'dashboard_tabs.goals.cancel' | translate">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="modal-body">
      <div class="delete-goal-preview" *ngIf="goalBeingDeleted">
        <div class="preview-content">
          <div class="preview-label">
            <i class="fas fa-bullseye"></i>
            <span>{{ 'dashboard_tabs.goals.goal_preview' | translate }}</span>
          </div>
          <div class="preview-text">
            <p><strong>{{ goalBeingDeleted.title }}</strong></p>
            <p *ngIf="goalBeingDeleted.description">{{ goalBeingDeleted.description }}</p>
          </div>
          <div class="preview-meta">
            <span class="preview-badge priority-badge" [ngClass]="{
              'priority-high': goalBeingDeleted.priority === 'high',
              'priority-medium': goalBeingDeleted.priority === 'medium',
              'priority-low': goalBeingDeleted.priority === 'low'
            }">
              <i class="fas fa-flag"></i>
              {{ getPriorityTranslation(goalBeingDeleted.priority) }}
            </span>
            <span class="preview-date">
              <i class="fas fa-calendar-alt"></i>
              {{ formatDate(goalBeingDeleted.target_date) }}
            </span>
            <span *ngIf="hasRepetition(goalBeingDeleted)" class="preview-badge repetition-badge">
              <i class="fas fa-repeat"></i>
              {{ getRepetitionTypeTranslation(goalBeingDeleted.repetition_type) }}
            </span>
          </div>
        </div>
      </div>
    </div>

    <div class="modal-footer">
      <button 
        type="button"
        class="modal-btn-secondary"
        (click)="closeDeleteGoalModal()"
        [disabled]="deletingGoal">
        <i class="fas fa-times"></i>
        {{ 'dashboard_tabs.goals.cancel' | translate }}
      </button>
      <button 
        type="button"
        class="modal-btn-danger"
        (click)="confirmDeleteGoal()"
        [disabled]="deletingGoal">
        <i class="fas fa-trash-alt"></i>
        {{ deletingGoal ? ('dashboard_tabs.goals.deleting' | translate) : ('dashboard_tabs.goals.confirm_delete' | translate) }}
      </button>
    </div>
  </div>
</div>

</div>