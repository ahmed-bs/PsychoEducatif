<div class="head-title">
  <div class="left">
    <h1>{{ 'evaluations.head_title.title' | translate }}</h1>
    <ul class="breadcrumb">
      <li>
        <a href="#">{{ 'evaluations.head_title.breadcrumb.dashboard' | translate }}</a>
      </li>
      <li><i class="bx bx-chevron-right"></i></li>
      <li>
        <a class="active" href="#">{{ 'evaluations.head_title.breadcrumb.evaluations_summary' | translate }}</a>
      </li>
    </ul>
  </div>

<div class="left">

</div>
  <div class="right"></div>
</div>
<div class="summary-container">
  <div *ngIf="isLoading" class="text-center">
    <p>{{ 'evaluations.loading.message' | translate }}</p>
  </div>
  <div *ngIf="error" class="alert alert-danger">
    {{ error }}
  </div>
  <div *ngIf="items.length > 0" class="mb-4">
    <h2 class="category-header">{{ getLanguageSpecificCategoryName() }}</h2>
    <h3 class="domain-header">{{ getLanguageSpecificDomainName() }}</h3>
  </div>
  <p-table [value]="filteredItems" [paginator]="true" [rows]="10" [responsive]="true" styleClass="p-datatable-striped p-datatable-gridlines">
    <ng-template pTemplate="caption">
      <div class="filter-container">
        <div class="filter-controls">
          <label for="statusFilter" class="filter-label">{{ 'evaluations.filter.filter_by_status' | translate }}:</label>
          <select id="statusFilter" [(ngModel)]="selectedStatusFilter" (change)="filterByStatus()" class="filter-select">
            <option *ngFor="let option of getStatusOptions()" [value]="option.value">{{ option.label }}</option>
          </select>
          <span class="filter-results">{{ 'evaluations.filter.showing_results' | translate }}: {{ filteredItems.length }} / {{ items.length }}</span>
        </div>
        <div class="button-container">
          <button pButton pRipple type="button" icon="pi pi-file-excel" [label]="'evaluations.table.caption.export_excel' | translate" class="p-button-success mr-2" (click)="exportExcel()" [disabled]="filteredItems.length === 0"></button>
          <button pButton pRipple type="button" icon="pi pi-file-pdf" [label]="'evaluations.table.caption.export_pdf' | translate" class="p-button-warning mr-2" (click)="exportPdf()" [disabled]="filteredItems.length === 0"></button>
        </div>
      </div>
    </ng-template>
    <ng-template pTemplate="header">
      <tr>
        <th>{{ 'evaluations.table.headers.items' | translate }}</th>
        <th>{{ 'evaluations.table.headers.status' | translate }}</th>
        <th>{{ 'evaluations.table.headers.comments' | translate }}</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-item>
      <tr>
        <td class="align-middle">{{ getItemLanguageField(item, 'description') || getItemLanguageField(item, 'name') }}</td>
        <td class="align-middle">
          <span [ngClass]="{
            'statut-badge statut-acquise': item.etat === 'ACQUIS',
            'statut-badge statut-non-acquise': item.etat === 'NON_ACQUIS',
            'statut-badge statut-non-evalue': item.etat === 'NON_COTE',
            'statut-badge statut-partiel': item.etat === 'PARTIEL'
          }">
            {{ item.etat === 'ACQUIS' ? ('evaluations.table.status_labels.ACQUIS' | translate) : 
               item.etat === 'NON_ACQUIS' ? ('evaluations.table.status_labels.NON_ACQUIS' | translate) : 
               item.etat === 'PARTIEL' ? ('evaluations.table.status_labels.PARTIEL' | translate) : 
               ('evaluations.table.status_labels.NON_COTE' | translate) }}
          </span>
        </td>
        <td class="align-middle">
          <div *ngIf="getItemLanguageField(item, 'comentaire')" class="comment-bubble">
            {{ getItemLanguageField(item, 'comentaire') }}
          </div>
          <div *ngIf="!item.comentaire" class="text-muted">
            {{ 'evaluations.table.no_comment' | translate }}
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>